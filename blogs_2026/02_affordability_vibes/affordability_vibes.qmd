---
title: "Consumer Spending on Essentials Increased Through 2024"
author: "Mike Konczal"
date: today
date-format: "MMMM D, YYYY"
format:
  html:
    code-fold: true
    code-summary: "Show code"
execute:
  echo: true
  message: false
  warning: false
---

```{r load_data}
#| echo: false
library(tidyverse)

median_income <- read_csv("data/real_median_household_income.csv") %>%
  mutate(date = as.Date(date))
cex <- read_csv("data/cex_data.csv") %>% filter(demographics_text != "Age of reference person")
```

## Introduction

## Real Median Household Income

Real median household income provides the broadest sense of how purchasing power has evolved over the long run.

```{r median_income_chart}
#| fig-width: 8.5
#| fig-height: 4.5

ggplot(median_income %>% filter(date >= as.Date("2000-01-01")),
       aes(x = date, y = value)) +
  geom_line(color = "#1F5A7A", linewidth = 1.6) +
  geom_point(
    data = median_income %>% slice_tail(n = 1),
    color = "#1F5A7A",
    size = 2.6
  ) +
  scale_x_date(date_breaks = "5 years", date_labels = "%Y") +
  scale_y_continuous(labels = scales::dollar_format(scale = 1 / 1000, suffix = "k")) +
  labs(
    title = "Graphic 1: Real Median Household Income in the United States",
    subtitle = "Inflation-adjusted dollars (Census definition)",
    x = NULL,
    y = "Median household income",
    caption = "Source: U.S. Census Bureau; Mike Konczal."
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title.position = "plot",
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(size = 11),
    axis.text.y = element_text(size = 11)
  )
```


## CPI: Which Essential Items Beat Overall Inflation?

```{r}
#| echo: false
cpi_changes <- read_csv("data/cpi_changes.csv")

# Get All Items change
cpi_raw <- read_csv("data/cpi_data.csv")
all_items_change <- cpi_raw %>%
  filter(item_name == "All items",
         date %in% as.Date(c("2019-12-01", "2025-12-01"))) %>%
  arrange(date) %>%
  summarize(pct = (last(value) / first(value) - 1) * 100) %>%
  pull(pct)
```

Between December 2019 and December 2025, overall CPI rose approximately `r round(all_items_change, 1)`%. But many essential categories exceeded that benchmark substantially.

```{r}
#| fig-width: 8.5
#| fig-height: 5

curated_items <- c(
  "Motor vehicle insurance", "Motor vehicle maintenance and repair",
  "Veterinarian services", "Energy services",
  "Fuels and utilities",
  "Food away from home", 
  "Food at home", "Owners' equivalent rent of residences",
  "Rent of primary residence", "Hospital and related services"
)

top_essentials <- cpi_changes %>%
  filter(item_name %in% curated_items, pct_change > all_items_change) %>%
  arrange(desc(pct_change))

ggplot(top_essentials,
       aes(x = pct_change, y = reorder(item_name, pct_change))) +
  geom_col(fill = "#2A9D8F") +
  geom_text(aes(label = paste0(round(pct_change, 1), "%")),
            hjust = -0.1, size = 4) +
  geom_vline(xintercept = all_items_change, linetype = "dashed",
             color = "gray25", linewidth = 0.8) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.2))) +
  labs(title = "Graphic 2: Essential CPI Items That Beat Overall Inflation, Dec 2019 to Dec 2025",
       subtitle = paste0(
         "Cumulative percent change, seasonally adjusted. Dashed line = All items (",
         round(all_items_change, 1), "%)"
       ),
       x = "Cumulative % Change", y = NULL,
       caption = "Source: BLS CPI; Mike Konczal.") +
  theme_minimal(base_size = 13) +
  theme(
    plot.title.position = "plot",
    axis.text.y = element_text(size = 11),
    axis.text.x = element_text(size = 11)
  )
```

Every item on this chart represents something households have little discretion over: shelter, food, transportation, medical care, utilities. Motor vehicle insurance and repair lead the pack, reflecting both higher car prices and supply chain disruptions rippling through the auto ecosystem. Shelter---the largest weight in the CPI basket---ran well above the overall average, as did food both at home and away.

## Method

We define core essentials as 'food at home' and 'housing.' We also check a broader essentials category by adding healthcare and transportation to the core set. Budget shares are computed by summing category expenditures and dividing by total expenditures ("average annual expenditures") for each group across years.

```{r essentials_setup}
#| echo: false
core_essentials <- c("Food at home", "Housing")
essentials <- c(core_essentials, "Healthcare", "Transportation")

totals <- cex %>%
  filter(item_text == "Average annual expenditures") %>%
  select(year, demographics_text, characteristics_text, total = value)

build_share <- function(items, label) {
  cex %>%
    filter(item_text %in% items) %>%
    group_by(year, demographics_text, characteristics_text) %>%
    summarise(essentials_value = sum(value, na.rm = TRUE), .groups = "drop") %>%
    left_join(totals, by = c("year", "demographics_text", "characteristics_text")) %>%
    mutate(
      essentials_share = essentials_value / total,
      essentials_type = label
    )
}

essentials_share <- bind_rows(
  build_share(core_essentials, "Core essentials"),
  build_share(essentials, "Essentials")
)

group_definitions <- tibble(
  group = c(
    "Overall",
    "Age 25-34",
    "Income: Lowest 20%",
    "Income: Second 20%",
    "Income: Third 20%",
    "Income: Fourth 20%",
    "Income: Highest 20%"
  ),
  demographics_text = c(
    "Quintiles of income before taxes",
    "Age of reference person",
    rep("Quintiles of income before taxes", 5)
  ),
  characteristics_text = c(
    "All Consumer Units",
    "Reference person from age 25 to 34",
    "Lowest 20 percent income quintile",
    "Second 20 percent income quintile",
    "Third 20 percent income quintile",
    "Fourth 20 percent income quintile",
    "Highest 20 percent income quintile"
  )
)

summarize_group <- function(demo_label, char_filter) {
  essentials_share %>%
    filter(
      demographics_text == demo_label,
      characteristics_text %in% char_filter
    ) %>%
    group_by(essentials_type, characteristics_text) %>%
    summarise(
      share_2019 = essentials_share[year == 2019][1],
      share_2024 = essentials_share[year == 2024][1],
      change_2019_2024 = share_2024 - share_2019,
      avg_2016_2019 = mean(essentials_share[year %in% 2016:2019], na.rm = TRUE),
      avg_2023_2024 = mean(essentials_share[year %in% 2023:2024], na.rm = TRUE),
      change_2016_2019_to_2023_2024 = avg_2023_2024 - avg_2016_2019,
      .groups = "drop"
    )
}

```

## Findings

### Overall (All Consumer Units)

```{r summary_results}
#| echo: false
overall <- summarize_group(
  "Quintiles of income before taxes",
  "All Consumer Units"
)
income <- summarize_group(
  "Quintiles of income before taxes",
  c(
    "Lowest 20 percent income quintile",
    "Second 20 percent income quintile",
    "Third 20 percent income quintile",
    "Fourth 20 percent income quintile",
    "Highest 20 percent income quintile"
  )
)

income_order <- c(
  "Lowest 20 percent income quintile",
  "Second 20 percent income quintile",
  "Third 20 percent income quintile",
  "Fourth 20 percent income quintile",
  "Highest 20 percent income quintile"
)

```

Essentials are modestly higher in 2024 than 2019 for overall consumer units, and the 2023-2024 average sits above 2016-2019.

### Income Quintiles

The lowest two income quintiles show the largest increases since 2019, while the highest quintile is flat to slightly down. The overall pattern suggests a rising essentials burden concentrated in lower- and lower-middle-income households. The figures below show both the 2019 vs 2024 comparison and the pre- vs post-pandemic averages.

## Essentials Visuals

The charts below show the share of expenditures devoted to core essentials (food at home + housing) and the broader essentials basket (adding healthcare and transportation) side by side. In both cases, the 2023--2024 average exceeds the pre-pandemic baseline, and the increase is concentrated in lower-income quintiles.

```{r essentials_side_by_side}
#| fig-width: 8.5
#| fig-height: 10.5

essentials_bar <- essentials_share %>%
  filter(year %in% c(2016:2019, 2023:2024)) %>%
  inner_join(group_definitions, by = c("demographics_text", "characteristics_text")) %>%
  mutate(
    period = if_else(year <= 2019, "2016-2019 avg", "2023-2024 avg"),
    period = factor(period, levels = c("2016-2019 avg", "2023-2024 avg")),
    group = factor(group, levels = group_definitions$group),
    essentials_type = factor(essentials_type, levels = c("Core essentials", "Essentials"))
  ) %>%
  group_by(essentials_type, group, period) %>%
  summarise(avg_share = mean(essentials_share, na.rm = TRUE), .groups = "drop")

ggplot(
  essentials_bar,
  aes(x = group, y = avg_share, fill = interaction(essentials_type, period))
) +
  geom_col(position = position_dodge2(width = 0.7, reverse = TRUE), width = 0.65) +
  geom_text(
    aes(label = scales::percent(avg_share, accuracy = 0.1)),
    position = position_dodge2(width = 0.7, reverse = TRUE),
    hjust = -0.12,
    size = 4,
    color = "black"
  ) +
  scale_y_continuous(
    labels = scales::percent_format(accuracy = 1),
    expand = expansion(mult = c(0, 0.2))
  ) +
  scale_fill_manual(
    values = c(
      "Core essentials.2016-2019 avg" = "#BFD5E6",
      "Core essentials.2023-2024 avg" = "#1F5A7A",
      "Essentials.2016-2019 avg" = "#F1B2B2",
      "Essentials.2023-2024 avg" = "#8B1A1A"
    ),
    breaks = c(
      "Core essentials.2016-2019 avg",
      "Core essentials.2023-2024 avg",
      "Essentials.2016-2019 avg",
      "Essentials.2023-2024 avg"
    ),
    labels = c(
      "Core 2016-2019 avg",
      "Core 2023-2024 avg",
      "Essentials 2016-2019 avg",
      "Essentials 2023-2024 avg"
    )
  ) +
  labs(
    title = "Graphic 3: Essentials Share of Expenditures by Income Group",
    subtitle = "Average share in 2016-2019 vs 2023-2024",
    x = NULL,
    y = "Share of expenditures",
    fill = NULL,
    caption = "Source: BLS CEX; Mike Konczal."
  ) +
  coord_flip() +
  facet_wrap(~ essentials_type, ncol = 1) +
  theme_minimal(base_size = 13) +
  theme(
    legend.position = "top",
    strip.text = element_text(size = 13, face = "bold"),
    axis.text.x = element_text(size = 11),
    axis.text.y = element_text(size = 11)
  )
```


Why did essentials budget shares rise? One key reason is that the prices of essentials rose faster than overall prices. Using the BEA's Personal Consumption Expenditures data, we can construct price indices that match the CEX definitions---a core essentials index (food at home + housing) and a broader essentials index (adding healthcare and transportation)---and compare them to overall PCE prices.

To build these indices we draw on BEA NIPA Tables 2.3.4 and 2.3.5. Table 2.3.4 provides chain-type price indices (2017 = 100) for each PCE expenditure category, while Table 2.3.5 provides the corresponding nominal expenditure levels from which we derive each category's share of total personal consumption expenditures. For each essentials bundle we renormalize the expenditure-share weights so they sum to one within the bundle, then aggregate monthly inflation using a Törnqvist index: the month-over-month log change in each component's price index is weighted by the average of the current and prior month's renormalized expenditure shares, and the resulting weighted log changes are cumulated to form a chained price level. The overall PCE line uses the published aggregate chain-type price index directly. Because the Törnqvist formula closely approximates the Fisher ideal index that BEA uses for its official aggregates, the essentials indices are directly comparable to the overall PCE series.

```{r pce_essentials_index}
#| fig-width: 8.5
#| fig-height: 5

all_indices <- read_csv("data/pce_essentials_indices.csv")

last_indices <- all_indices %>%
  group_by(index_type) %>%
  filter(date == max(date)) %>%
  ungroup() %>%
  mutate(
    pct_increase = index_norm - 100,
    label = scales::percent(pct_increase / 100, accuracy = 1)
  )

ggplot(all_indices %>% filter(date >= as.Date("2017-01-01")),
       aes(x = date, y = index_norm, color = index_type)) +
  geom_line(linewidth = 1.5) +
  geom_point(
    data = last_indices,
    size = 2.6,
    show.legend = FALSE
  ) +
  geom_text(
    data = last_indices,
    aes(label = label),
    hjust = -0.2,
    size = 4,
    show.legend = FALSE
  ) +
  scale_x_date(expand = expansion(mult = c(0.01, 0.08))) +
  scale_color_manual(values = c(
    "Core Essentials" = "#1F5A7A",
    "Essentials" = "#8B1A1A",
    "Overall PCE" = "#4E7D2B"
  )) +
  labs(title = "Graphic 4: PCE Price Indices, Core Essentials, Essentials, and Overall",
       subtitle = "Core = food at home + housing; Essentials adds healthcare + transportation",
       x = NULL, y = "Index (Dec 2019 = 100)", color = NULL,
       caption = "Source: BEA PCE; Mike Konczal.") +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "top",
    plot.title.position = "plot",
    axis.text.x = element_text(size = 12),
    axis.text.y = element_text(size = 12)
  )
```

Both essentials price indices tracked overall PCE closely through 2019. Starting in 2021, a gap emerged---core essentials prices rose faster than overall prices, and the broader essentials index followed. This price divergence is the mechanism behind the rising budget shares: when the things you must buy get more expensive faster than the average, they consume a larger share of your budget even if your income keeps pace with headline inflation.

```{r pce_pre2019_changes}
#| echo: true

pre2019_start <- as.Date("2013-12-01")
pre2019_end <- as.Date("2019-11-01")

pre2019_changes <- all_indices %>%
  filter(date %in% c(pre2019_start, pre2019_end)) %>%
  select(date, index_type, index_norm) %>%
  pivot_wider(names_from = date, values_from = index_norm) %>%
  mutate(
    pct_increase = (`2019-11-01` / `2013-12-01` - 1) * 100
  )

pre2019_lookup <- pre2019_changes %>%
  transmute(index_type, pct_increase) %>%
  deframe()
```

From December 2013 to November 2019 (six years minus one month, matching the Dec 2019 to Nov 2025 window), Core Essentials rose about `r round(pre2019_lookup["Core Essentials"], 1)`%, Essentials rose about `r round(pre2019_lookup["Essentials"], 1)`%, and Overall PCE rose about `r round(pre2019_lookup["Overall PCE"], 1)`%.
