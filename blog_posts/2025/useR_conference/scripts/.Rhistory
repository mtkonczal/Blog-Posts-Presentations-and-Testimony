scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme_chartbook()
df <- getFRED(c("UNEMPLOY", "CLF16OV")) %>%
mutate(unrate = unemploy/clf16ov) %>%
select(date, unrate) %>%
left_join(mich_cs, by="date") %>%
filter(date >= "1978-01-01") %>%
select(-Month, -YYYY) %>%
rename(sentiment_index = ICS_ALL)
max_lag <- 18                # months to push UNRATE backward / forward
cor_tbl2 <- tibble(k = -max_lag:max_lag) |>
mutate(correlation = map_dbl(k, \(k) {
shifted_unrate <- if (k >= 0) {
lead(df$unrate,  n = k)          # +k → UNRATE in the FUTURE
} else {
lag(df$unrate,  n = abs(k))      # −k → UNRATE in the PAST
}
cor(shifted_unrate, df$sentiment_index, use = "complete.obs")
}))
# ---- Plot ---------------------------------------------------------------
corr_graphic <- ggplot(cor_tbl2, aes(k, correlation)) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme_chartbook()
source("scripts/hard_soft_correlation.R")
print(corr_graphic)
corr_graphic
df <- getFRED(c("UNEMPLOY", "CLF16OV")) %>%
mutate(unrate = unemploy/clf16ov) %>%
select(date, unrate) %>%
left_join(mich_cs, by="date") %>%
filter(date >= "1978-01-01") %>%
select(-Month, -YYYY) %>%
rename(sentiment_index = ICS_ALL)
max_lag <- 18                # months to push UNRATE backward / forward
cor_tbl2 <- tibble(k = -max_lag:max_lag) |>
mutate(correlation = map_dbl(k, \(k) {
shifted_unrate <- if (k >= 0) {
lead(df$unrate,  n = k)          # +k → UNRATE in the FUTURE
} else {
lag(df$unrate,  n = abs(k))      # −k → UNRATE in the PAST
}
cor(shifted_unrate, df$sentiment_index, use = "complete.obs")
}))
# ---- Plot ---------------------------------------------------------------
corr_graphic <- ggplot(cor_tbl2, aes(k, correlation)) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme_chartbook()
source("scripts/hard_soft_correlation.R")
print(corr_graphic)
mich_cs <- read_csv("https://www.sca.isr.umich.edu/files/tbmics.csv") %>%
mutate(
Month = str_to_title(Month),
date = my(paste(Month, YYYY))
)
mich_cs %>%
filter(year(date) >= 2012) %>%
ggplot(aes(date, ICS_ALL)) +
geom_line(size = 1) +
labs(subtitle = "Index of Consumer Sentiment") +
theme_chartbook()
source("scripts/hard_soft_correlation.R")
print(corr_graphic)
ggplot(cor_tbl2, aes(k, correlation)) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme_chartbook()
ggplot(cor_tbl2, aes(k, correlation)) +
theme_chartbook() +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_chartbook() +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_chartbook() +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted"
)
ggplot(cor_tbl2, aes(k, correlation)) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_chartbook() +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
theme(axis.title = element_text(size = 12)) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_chartbook() +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = -max_lag:max_lag) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
-max_lag:max_lag
seq(-max_lag:max_lag,2)
seq(-max_lag:max_lag)
seq(-max_lag:max_lag, by=2)
seq()
?seq
seq(from = -max_lag, to = max_lag, by=2)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_chartbook() +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = seq(from = -max_lag, to = max_lag, by=2)) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_classic(base_size = 20)
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = seq(from = -max_lag, to = max_lag, by=2)) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_classic(base_size = 20) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = seq(from = -max_lag, to = max_lag, by=2)) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
)
ggplot(cor_tbl2, aes(k, correlation)) +
theme_classic(base_size = 20) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = seq(from = -max_lag, to = max_lag, by=2)) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme(plot.title.position = "plot")
cor_tbl2
df
ggplot(cor_tbl2, aes(k, correlation)) +
theme_classic(base_size = 20) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = seq(from = -max_lag, to = max_lag, by=2)) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment. Monthly, 1978-2025.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme(plot.title.position = "plot")
ggplot(cor_tbl2, aes(k, correlation)) +
theme_classic(base_size = 18) +
geom_line() +
geom_point(size = 2) +
geom_vline(xintercept = 0, linetype = "dashed") +   # contemporaneous
geom_hline(yintercept = 0, linetype = "dotted") +
scale_x_continuous(breaks = seq(from = -max_lag, to = max_lag, by=2)) +
theme(axis.title = element_text()) +
labs(
title    = "Consumer Sentiment Shifts Most Correlated with Unemployment 10 Months Out",
subtitle = "Correlation between unemployment and index of consumer sentiment. Monthly, 1978-2025.",
x        = "Number of months unemployment is shifted",
y        = ""
) +
theme(plot.title.position = "plot")
mich_cs <- read_csv("https://www.sca.isr.umich.edu/files/tbmics.csv") %>%
mutate(
Month = str_to_title(Month),
date = my(paste(Month, YYYY))
)
mich_cs %>%
filter(year(date) >= 2012) %>%
ggplot(aes(date, ICS_ALL)) +
geom_line(size = 1) +
labs(subtitle = "Index of Consumer Sentiment") +
theme_chartbook()
mich_cs <- read_csv("https://www.sca.isr.umich.edu/files/tbmics.csv") %>%
mutate(
Month = str_to_title(Month),
date = my(paste(Month, YYYY))
)
mich_cs %>%
filter(year(date) >= 2012) %>%
ggplot(aes(date, ICS_ALL)) +
geom_line(size = 1) +
labs(subtitle = "Index of Consumer Sentiment") +
theme_chartbook()
df <- read_csv("https://www.sca.isr.umich.edu/files/tbmpx1px5.csv") %>%
mutate(
Month = str_to_title(Month),
date = my(paste(Month, YYYY))
)
df %>%
filter(year(date) >= 2012) %>%
pivot_longer(PX_MD:PX5_MD, names_to = "type", values_to = "value") %>%
mutate(value = value/100,
type = case_when(
type == "PX_MD" ~ "Inflation over the next year",
TRUE ~ "Inflation over the next 5-10 years"
)) %>%
ggplot(aes(date, value, color = type)) +
geom_line() +
labs(title = "Inflation") +
theme_chartbook() +
scale_chartbook_colors() +
scale_y_continuous(label = percent) +
theme(legend.position = "top")
knitr::opts_chunk$set(
echo = FALSE,
warning = FALSE,
message = FALSE
)
library(tidyverse)
library(govMacroTools)
library(lubridate)
library(scales)
library(glue)
library(blsR)
library(showtext)
font_add_google("Fira Sans", "fira")
showtext_auto()
theme_chartbook <- function() {
theme_void(base_family = "fira", base_size = 12) +
theme(
plot.title = element_text(size = 12, hjust = 0),
plot.title.position = "plot",
plot.background = element_rect(fill = NA, color = NA),
panel.background = element_rect(fill = NA, color = NA),
axis.text = element_text(size = 12),
axis.title = element_blank(),
panel.grid = element_blank(),
legend.title = element_blank()
)
}
scale_chartbook_colors <- function() {
scale_color_manual(values = presentation_two_colors)
}
scale_chartbook_fill <- function() {
scale_fill_manual(values = presentation_two_colors)
}
presentation_two_colors <- c("#2c3254", "#ff8361")  # Blue, red (or whatever you prefer)
# Set global ggplot defaults
update_geom_defaults("line", list(color = presentation_two_colors[1]))
update_geom_defaults("bar",  list(fill = presentation_two_colors[1]))
update_geom_defaults("col",  list(fill = presentation_two_colors[1]))
df <- read_csv("https://www.sca.isr.umich.edu/files/tbmpx1px5.csv") %>%
mutate(
Month = str_to_title(Month),
date = my(paste(Month, YYYY))
)
df %>%
filter(year(date) >= 2012) %>%
pivot_longer(PX_MD:PX5_MD, names_to = "type", values_to = "value") %>%
mutate(
value = value / 100,
type = case_when(
type == "PX_MD" ~ "Inflation over the next year",
TRUE ~ "Inflation over the next 5-10 years"
),
type = fct_relevel(type, "Inflation over the next year")
) %>%
ggplot(aes(date, value, color = type)) +
geom_line() +
labs(title = "Inflation") +
theme_chartbook() +
scale_chartbook_colors() +
scale_y_continuous(label = percent) +
theme(legend.position = "top")
source("scripts/graphic_rgdp.R")
print(rgdp_graphic)
source("scripts/graphic_rgdp.R")
print(rgdp_graphic +
labs(subtitle = ""))
df <- getFRED(c("A191RL1Q225SBEA","PB0000031Q225SBEA"), rename_variables = c("real_gdp", "real_private_final_demand"))
df
getFRED("USEPUINDXD")
uncertainty <- getFRED("USEPUINDXD")
uncertainty
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd))
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd))
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd))
tail(
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd)))
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd)) %>%
ungroup() %>%
mutate(date = my(paste(Month, YYYY))
)
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd)) %>%
ungroup() %>%
mutate(date = my(paste(month, YYYY)))
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd)) %>%
ungroup() %>%
mutate(date = my(paste(month, year)))
uncertainty <- getFRED("USEPUINDXD")
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd)) %>%
ungroup() %>%
mutate(date = my(paste(month, year)))
filter(year(date) >= 2018) %>%
ggplot(aes(date, uncertainty)) +
geom_line() +
labs(subtitle = "Economic uncertainty index") +
theme_chartbook() +
scale_chartbook_colors()
uncertainty <- getFRED("USEPUINDXD")
uncertainty %>%
mutate(month = month(date),
year = year(date)) %>%
group_by(month, year) %>%
reframe(uncertainty = mean(usepuindxd)) %>%
ungroup() %>%
mutate(date = my(paste(month, year))) %>%
filter(year(date) >= 2018) %>%
ggplot(aes(date, uncertainty)) +
geom_line() +
labs(subtitle = "Economic uncertainty index") +
theme_chartbook() +
scale_chartbook_colors()
source("scripts/unrate_jobs.R")
print(jobs_gained_graphic)
unrate %>%
mutate(
dateTag = if_else(date >= max(date) %m-% months(5), ces, NA),
ces3m = ces + lag(ces, 1) + lag(ces, 2),
ces3m = ces3m / 3
) %>%
filter(date >= "2023-01-01") %>%
ggplot(aes(date, ces, label = dateTag)) +
geom_col(size = 0) +
labs(
subtitle = "Monthly jobs gained. CES",
) +
theme_chartbook() +
scale_chartbook_fill()
getFRED(c("dgs10")) %>%
mutate(dgs10 = as.numeric(dgs10)/100) %>%
filter(!is.na(date),
date > max(date) %m-% months(5)) %>%
ggplot(aes(date, dgs10)) +
geom_line(size = 1.2) +
labs(
subtitle = "Nominal Broad U.S. Dollar Index"
) +
theme_chartbook() +
scale_chartbook_colors() +
scale_y_continuous(label = percent) +
geom_vline(xintercept = as.Date("2025-04-02"))
getFRED(c("dgs10")) %>%
mutate(dgs10 = as.numeric(dgs10)/100) %>%
filter(!is.na(date),
date > max(date) %m-% months(5)) %>%
ggplot(aes(date, dgs10)) +
geom_line(size = 1.2) +
labs(
subtitle = "Nominal Broad U.S. Dollar Index"
) +
theme_chartbook() +
scale_chartbook_colors() +
scale_y_continuous(label = percent) +
geom_vline(xintercept = as.Date("2025-04-02"))
getFRED(c("DTWEXBGS")) %>%
mutate(us_dollar = as.numeric(dtwexbgs)) %>%
filter(date > max(date) %m-% months(24)) %>%
ggplot(aes(date, us_dollar)) +
geom_line(size = 1.2) +
labs(
subtitle = "Nominal Broad U.S. Dollar Index"
) +
theme_chartbook() +
scale_chartbook_colors() +
geom_vline(xintercept = as.Date("2025-04-02"))
