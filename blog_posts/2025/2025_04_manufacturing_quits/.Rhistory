y_lab <- switch(use_case,
relative = "% change from base year (6-mo avg.)",
absolute = "pp change from base year (6-mo avg.)",
level    = "Quits rate")
plot_data <- change_flows %>%
filter(!is.na(.data[[var_to_plot]]),
year(date) >= 2011)
# pick label dates: manufacturing at 2022-07-01, leisure one year earlier
label_dates <- c("Manufacturing"            = as.Date("2022-07-01"),
"Leisure and hospitality"  = as.Date("2013-09-01"))
label_pts <- purrr::map_dfr(names(label_dates), \(ind) {
plot_data %>%
filter(industry_text == ind, date == label_dates[[ind]])
})
label_pts <- label_pts %>%
filter(industry_text %in% highlight_industries)
# ---------------- 4.  Plot ---------------------------------------------
ggplot() +
# background (non-highlight) lines
geom_line(
data = filter(plot_data, !industry_text %in% highlight_industries),
aes(date, .data[[var_to_plot]], group = industry_text),
colour = "grey50", alpha = 0.4, linewidth = 0.9
) +
# highlight lines
geom_line(
data = filter(plot_data, industry_text %in% highlight_industries),
aes(date, .data[[var_to_plot]], colour = industry_text),
linewidth = 1.2
) +
scale_colour_manual(values = highlight_cols, guide = "none") +
# inline text labels
geom_text(
data = label_pts,
aes(date, .data[[var_to_plot]], label = industry_text, colour = industry_text),
hjust = -0.1, vjust = -0.6, fontface = "bold"
) +
scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title    = "Placeholder",
subtitle = "Placeholder",
x = NULL, y = y_lab,
caption = "Two-digit industries shown are: Mining and logging, Construction, Manufacturing, Trade, transportation, and utilities, Information, Financial activities, Professional and business services,\nPrivate education and health services, Leisure and hospitality, Other services, Federal government, State and local government.\nMike Konczal"
) +
coord_cartesian(clip = "off") +
theme_classic(base_size = 11) +
theme(plot.title = element_text(face = "bold"),
plot.margin = margin(10, 20, 10, 10),
plot.title.position = "plot",
axis.title=element_text(size=8),
plot.caption = element_text(size=6)
)
}
make_jolts_graphic(jolts, use_case = "relative", highlight_industries = "Manufacturing") +
labs(title = "Figure 2: Manufacturing Had the Highest Relative Increase in Quits During Pandemic",
subtitle = "JOLTS quit rate by two-digit industries, six-month average, relative change compared to 2019 annual.",
y = "6m average % change from own 2019 annual rate") +
theme(plot.title = element_text(size = 10),
plot.subtitle = element_text(size = 10))
ggsave("graphics/g2_relative.png", width = 2190, height = 1200, dpi = 300, units = "px")
make_jolts_graphic(jolts, use_case = "absolute") +
labs(title = "Figure 3: Manufacturing Rivals Hospitality For Highest Absolute Increase in Quits During Pandemic",
subtitle = "JOLTS quit rate by two-digit industries, six-month average, absolute change compared to 2019 annual.",
y = "6m average minus 2019 own average quit rate") +
theme(plot.title = element_text(size = 10),
plot.subtitle = element_text(size = 10))
ggsave("graphics/g3_absolute.png", width = 2190, height = 1200, dpi = 300, units = "px")
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
)
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
ggplot(aes(industry_text, value)) + geom_bar()
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
ggplot(aes(industry_text, value)) + geom_col()
ces_data <- ces %>%
filter(year == 2024, period == "M13") %>%
mutate(data_type_code = as.numeric(data_type_code))
ces_last <- ces_data %>%
filter(series_id == "CEU0000000001") %>%
pull(value)
jobs_chart <- ces_data %>%
filter(display_level <= 2, data_type_code == 1) %>%
group_by(industry_name) %>%
reframe(
total_jobs = value,
series_id = series_id
)
jobs_chart <- jobs_chart %>%
mutate(chart_type = case_when(
industry_name %in% c("Total nonfarm", "Goods-producing", "Private service-providing", "Total private") ~ "Total",
TRUE ~ "Goods and Services"
)) %>%
mutate(chart_type = factor(chart_type, levels = c("Total", "Goods and Services"))) %>%
filter(industry_name != "Service-providing")
wage_data <- ces_data %>%
filter((display_level <= 2 & data_type_code == 3)) %>%
group_by(industry_name) %>%
summarize(last_wages = value) %>%
ungroup()
jobs_chart2 <- jobs_chart %>%
mutate(percent_jobs = total_jobs/ces_last) %>%
left_join(wage_data, by = "industry_name") %>%
#left_join(industry_timeline, by = "series_id") %>%
mutate(industry_name = if_else(industry_name == "Total nonfarm", "All jobs", industry_name)) %>%
arrange(last_wages)
cum_wages <- jobs_chart2 %>%
filter(chart_type == "Goods and Services", industry_name != "Government") %>%
mutate(percent_jobs2 = percent_jobs/sum(percent_jobs),
dist = cumsum(percent_jobs2)) %>%
select(industry_name, dist)
jobs_chart2 %>%
left_join(cum_wages, by="industry_name") %>%
select(-series_id) %>%
gt(groupname_col = "chart_type") %>%
row_group_order(groups = c("Total", "Goods and Services")) %>%
tab_header(title = "Figure 5: Slight Majority of Jobs Pay More Than Manufacturing",
subtitle = "Values are average within 2024.") %>%
cols_label(
industry_name = "",
total_jobs = "Total Jobs",
percent_jobs = "% of Jobs",
last_wages = "Average Hourly\nEarnings",
dist = "Culminative Private\nWage Distribution"
) %>%
tab_source_note(
source_note = "BLS data, author's calculations. Average values in 2024. Mike Konczal."
) %>%
opt_stylize(style = 6, color = "blue") %>%
fmt_percent(columns = c(percent_jobs, dist),
decimals = 1) %>%
sub_missing(missing_text = "") %>%
fmt_currency(columns = last_wages,
currency = "dollar") %>%
tab_style(
style = cell_fill(color = "lightyellow"),
locations = cells_body(
rows = industry_name == "Manufacturing"
)
)
ces_data <- ces %>%
filter(year == 2024, period == "M13") %>%
mutate(data_type_code = as.numeric(data_type_code))
ces_last <- ces_data %>%
filter(series_id == "CEU0000000001") %>%
pull(value)
jobs_chart <- ces_data %>%
filter(display_level <= 2, data_type_code == 1) %>%
group_by(industry_name) %>%
reframe(
total_jobs = value,
series_id = series_id
)
jobs_chart <- jobs_chart %>%
mutate(chart_type = case_when(
industry_name %in% c("Total nonfarm", "Goods-producing", "Private service-providing", "Total private") ~ "Total",
TRUE ~ "Goods and Services"
)) %>%
mutate(chart_type = factor(chart_type, levels = c("Total", "Goods and Services"))) %>%
filter(industry_name != "Service-providing")
wage_data <- ces_data %>%
filter((display_level <= 2 & data_type_code == 3)) %>%
group_by(industry_name) %>%
summarize(last_wages = value) %>%
ungroup()
jobs_chart2 <- jobs_chart %>%
mutate(percent_jobs = total_jobs/ces_last) %>%
left_join(wage_data, by = "industry_name") %>%
#left_join(industry_timeline, by = "series_id") %>%
mutate(industry_name = if_else(industry_name == "Total nonfarm", "All jobs", industry_name)) %>%
arrange(last_wages)
cum_wages <- jobs_chart2 %>%
filter(chart_type == "Goods and Services", industry_name != "Government") %>%
mutate(percent_jobs2 = percent_jobs/sum(percent_jobs),
dist = cumsum(percent_jobs2)) %>%
select(industry_name, dist)
jobs_chart2 %>%
left_join(cum_wages, by="industry_name") %>%
select(-series_id) %>%
gt(groupname_col = "chart_type") %>%
row_group_order(groups = c("Total", "Goods and Services")) %>%
tab_header(title = "Figure 5: Slight Majority of Jobs Pay More Than Manufacturing",
subtitle = "Values are average within 2024.") %>%
cols_label(
industry_name = "",
total_jobs = "Total Jobs",
percent_jobs = "% of Jobs",
last_wages = "Average Hourly\nEarnings",
dist = "Culminative Private\nWage Distribution"
) %>%
tab_source_note(
source_note = "BLS data, author's calculations. Average values in 2024. Mike Konczal."
) %>%
opt_stylize(style = 6, color = "blue") %>%
fmt_percent(columns = c(percent_jobs, dist),
decimals = 1) %>%
sub_missing(missing_text = "") %>%
fmt_currency(columns = last_wages,
currency = "dollar") %>%
tab_style(
style = cell_fill(color = "lightyellow"),
locations = cells_body(
rows = industry_name == "Manufacturing"
)
)
ces_data <- ces %>%
filter(year == 2024, period == "M13") %>%
mutate(data_type_code = as.numeric(data_type_code))
ces_last <- ces_data %>%
filter(series_id == "CEU0000000001") %>%
pull(value)
jobs_chart <- ces_data %>%
filter(display_level <= 2, data_type_code == 1) %>%
group_by(industry_name) %>%
reframe(
total_jobs = value,
series_id = series_id
)
jobs_chart <- jobs_chart %>%
mutate(chart_type = case_when(
industry_name %in% c("Total nonfarm", "Goods-producing", "Private service-providing", "Total private") ~ "Total",
TRUE ~ "Goods and Services"
)) %>%
mutate(chart_type = factor(chart_type, levels = c("Total", "Goods and Services"))) %>%
filter(industry_name != "Service-providing")
wage_data <- ces_data %>%
filter((display_level <= 2 & data_type_code == 3)) %>%
group_by(industry_name) %>%
summarize(last_wages = value) %>%
ungroup()
jobs_chart2 <- jobs_chart %>%
mutate(percent_jobs = total_jobs/ces_last) %>%
left_join(wage_data, by = "industry_name") %>%
#left_join(industry_timeline, by = "series_id") %>%
mutate(industry_name = if_else(industry_name == "Total nonfarm", "All jobs", industry_name)) %>%
arrange(last_wages)
cum_wages <- jobs_chart2 %>%
filter(chart_type == "Goods and Services", industry_name != "Government") %>%
mutate(percent_jobs2 = percent_jobs/sum(percent_jobs),
dist = cumsum(percent_jobs2)) %>%
select(industry_name, dist)
jobs_chart2 %>%
left_join(cum_wages, by="industry_name") %>%
select(-series_id) %>%
gt(groupname_col = "chart_type") %>%
row_group_order(groups = c("Total", "Goods and Services")) %>%
tab_header(title = "Figure 5: Slight Majority of Jobs Pay More Than Manufacturing",
subtitle = "Values are average within 2024.") %>%
cols_label(
industry_name = "",
total_jobs = "Total Jobs",
percent_jobs = "% of Jobs",
last_wages = "Average Hourly\nEarnings",
dist = "Culminative Private\nWage Distribution"
) %>%
tab_source_note(
source_note = "BLS data, author's calculations. Average values in 2024, no government pay data. Mike Konczal."
) %>%
opt_stylize(style = 6, color = "blue") %>%
fmt_percent(columns = c(percent_jobs, dist),
decimals = 1) %>%
sub_missing(missing_text = "") %>%
fmt_currency(columns = last_wages,
currency = "dollar") %>%
tab_style(
style = cell_fill(color = "lightyellow"),
locations = cells_body(
rows = industry_name == "Manufacturing"
)
)
highlight_clr <- "#2c3254"   # same dark blue you used before
other_clr     <- "grey80"
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value, .desc = TRUE) # hi → low order
) %>%
ggplot(aes(industry_text, value,
fill = industry_text == "Manufacturing")) +            # TRUE / FALSE flag
geom_col(alpha = 0.9) +
coord_flip() +
scale_fill_manual(values = c(`TRUE` = highlight_clr,
`FALSE` = other_clr),
guide = "none") +
scale_y_continuous(labels = percent_format(accuracy = 0.1)) +
theme_classic(base_size = 15) +
labs(
title    = "Quit Rates by Industry, 2018 (Annual-Average)",
subtitle = "Display-level 2 industries, seasonally adjusted ‒ Manufacturing highlighted",
caption  = "Source: BLS JOLTS | Figure design: Mike Konczal",
x = NULL, y = NULL
) +
theme(plot.title.position = "plot")
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value, .desc = TRUE) # hi → low order
)
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value, .desc = TRUE) # hi → low order
) %>% select(value, industry_text)
highlight_clr <- "#2c3254"   # same dark blue you used before
other_clr     <- "grey80"
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value) # hi → low order
) %>%
ggplot(aes(industry_text, value,
fill = industry_text == "Manufacturing")) +            # TRUE / FALSE flag
geom_col(alpha = 0.9) +
coord_flip() +
scale_fill_manual(values = c(`TRUE` = highlight_clr,
`FALSE` = other_clr),
guide = "none") +
scale_y_continuous(labels = percent_format(accuracy = 0.1)) +
theme_classic(base_size = 15) +
labs(
title    = "Quit Rates by Industry, 2018 (Annual-Average)",
subtitle = "Display-level 2 industries, seasonally adjusted ‒ Manufacturing highlighted",
caption  = "Source: BLS JOLTS | Figure design: Mike Konczal",
x = NULL, y = NULL
) +
theme(plot.title.position = "plot")
highlight_clr <- "#2c3254"   # same dark blue you used before
other_clr     <- "grey80"
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value) # hi → low order
) %>%
ggplot(aes(industry_text, value,
fill = industry_text == "Manufacturing")) +            # TRUE / FALSE flag
geom_col(alpha = 0.9) +
coord_flip() +
scale_fill_manual(values = c(`TRUE` = highlight_clr,
`FALSE` = other_clr),
guide = "none") +
scale_y_continuous(labels = percent_format(accuracy = 0.1)) +
theme_classic(base_size = 15) +
labs(
title    = "Quit Rates by Industry, 2018 (Annual-Average)",
subtitle = "Display-level 2 industries, seasonally adjusted ‒ Manufacturing highlighted",
caption  = "Source: BLS JOLTS. Mike Konczal",
x = NULL, y = NULL
) +
theme(plot.title.position = "plot")
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2018,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value, .desc = TRUE) # hi → low order
) %>% select(value, industry_text)
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2017,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value) # hi → low order
) %>%
ggplot(aes(industry_text, value,
fill = industry_text == "Manufacturing")) +            # TRUE / FALSE flag
geom_col(alpha = 0.9) +
coord_flip() +
scale_fill_manual(values = c(`TRUE` = highlight_clr,
`FALSE` = other_clr),
guide = "none") +
scale_y_continuous(labels = percent_format(accuracy = 0.1)) +
theme_classic(base_size = 15) +
labs(
title    = "Quit Rates by Industry, 2018 (Annual-Average)",
subtitle = "Display-level 2 industries, seasonally adjusted ‒ Manufacturing highlighted",
caption  = "Source: BLS JOLTS. Mike Konczal",
x = NULL, y = NULL
) +
theme(plot.title.position = "plot")
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2019,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value) # hi → low order
) %>%
ggplot(aes(industry_text, value,
fill = industry_text == "Manufacturing")) +            # TRUE / FALSE flag
geom_col(alpha = 0.9) +
coord_flip() +
scale_fill_manual(values = c(`TRUE` = highlight_clr,
`FALSE` = other_clr),
guide = "none") +
scale_y_continuous(labels = percent_format(accuracy = 0.1)) +
theme_classic(base_size = 15) +
labs(
title    = "Quit Rates by Industry, 2018 (Annual-Average)",
subtitle = "Display-level 2 industries, seasonally adjusted ‒ Manufacturing highlighted",
caption  = "Source: BLS JOLTS. Mike Konczal",
x = NULL, y = NULL
) +
theme(plot.title.position = "plot")
jolts %>%
filter(
display_level.x == 2,
period == "M13",
dataelement_code == "QU",
year == 2017,
ratelevel_code   == "R",
state_text       == "Total US"
) %>%
mutate(
value         = value / 100,                                    # rate → proportion
industry_text = fct_reorder(industry_text, value) # hi → low order
) %>%
ggplot(aes(industry_text, value,
fill = industry_text == "Manufacturing")) +            # TRUE / FALSE flag
geom_col(alpha = 0.9) +
coord_flip() +
scale_fill_manual(values = c(`TRUE` = highlight_clr,
`FALSE` = other_clr),
guide = "none") +
scale_y_continuous(labels = percent_format(accuracy = 0.1)) +
theme_classic(base_size = 15) +
labs(
title    = "Quit Rates by Industry, 2018 (Annual-Average)",
subtitle = "Display-level 2 industries, seasonally adjusted ‒ Manufacturing highlighted",
caption  = "Source: BLS JOLTS. Mike Konczal",
x = NULL, y = NULL
) +
theme(plot.title.position = "plot")
ggsave("graphics/g0_overview.png", width = 2190, height = 1000, dpi = 300, units = "px")
